# Обучение LoRA базовой LLM под специфические нужды.

## Инструкции

* `./infra/README.md` - настройка окружения и инфраструктуры
* `./experiments/README.md` - как проводить эксперименты

## Постановка задачи

В рамках данного проекта будет реализована агентская система для помощи исследователям в 
различных областях. Построение такой агентской системы production уровня требует наличия среды 
для разработки этой системы, сервинга самого агента и среды для экспериментирования различных 
вариантов и конфигураций. Другими словами, планируется разработки следующих платформ:

* Платформа для разработки сервиса
* Платформа для сервинга сервиса
* Платформа для экспериментирования
* Возможно, отдельная платформа для A/B тестирования

Для всего сервиса выставляются такие технические требования:

* Возможность работы всех платформ на одной машине
* Возможность простого горизонтального масштабирования каждой платформы
* Модульность. Каждая платформа по отдельности и отдельные части одной платформы должны иметь 
  модульную / микросервисную структуру
* Возможность разделения всех платформ на отдельные проекты в будущем (разделение на отдельные 
  репозитории, пайплайны, CI/CD и т.д.)
* Простота разворачивания сервиса, IaC
* Наличие системы тестов при деплое и fail-safe режимы
* Прозрачный мониторинг всей системы

## Бизнес описание работы агентской системы

...

### Метрики

* Основные: BLEU, CodeBLEU - измеряет пресечение слов / биграмм в исходных и сгенерированных
  текстах.
* Для суммаризации: BERTScore - измеряет семантическую близость исходных и сгенерированных текстов.
* Для генерации кода: pass@k на бенчмарках (например HumanEval) - измеряет вероятность, что хотя бы
  один из топ-К ответов правильный

## Валидация и тест

...

## Датасеты

* https://huggingface.co/datasets/ccdv/arxiv-summarization - датасет статей arxiv с разметкой
  “article - abstract”. Уже имеет разбиение train / validation / test примерно 200000 / 6000 / 6000.
  Будет использоваться дефолтное разбиение.
* https://huggingface.co/datasets/nvidia/OpenCodeInstruct - датасет с разметкой “input human
  instruction - code implementation”. Датасет имеет 5млн размеченных промптов. В зависимости от
  ресурсов доступных при обучении, будет выбрано не менее 100000 / 5000 / 5000 семплов.
* https://huggingface.co/datasets/openai/openai_humaneval - датасет с 164 задачами для тестирования
  результатов, оценка по Global leaderboard

## Моделирование

### Бейзлайн

Ministral 3b

### Основная модель

Ministral 3b + LoRA адаптер для суммаризации
Ministral 3b + LoRA адаптер для задач кодинга

## Внедрение

TBD
